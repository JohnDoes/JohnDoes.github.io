<!doctype HTML>
<html>

<!--
	trash
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ar.js/2.1.1/aframe-ar.min.js"></script>

-->
   <!-- A-Frame ライブラリの読み込み -->
   <script src="https://aframe.io/releases/0.6.1/aframe.min.js"></script>
   <!-- AR.js ライブラリの読み込み -->
   <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>

    <script type="text/javascript">
		document.addEventListener('DOMContentLoaded', (event) => {
		  var orientation = screen.msOrientation || screen.mozOrientation || (screen.orientation || {}).type;
		  if (orientation === "portrait-secondary" || orientation === "portrait-primary") {
			window.stop = true;
			var judge = confirm("このページは横向き専用です。　デバイスを横向きにしましたか？");
			if(judge) {
			  window.stop = false;
			}else {
			  alert("このページは横向き専用です。")
			}
		  }
		});
	  </script>
  
<!-- support 3D text 
<script src="https://unpkg.com/aframe-text-geometry-component@^0.5.0/dist/aframe-text-geometry-component.min.js"></script>
-->
<body style="margin: 0px; overflow: hidden;">
<a-scene embedded vr-mode-ui="enabled: false;" arjs="debugUIEnabled: true;">
	<a-assets>
		<video id="video_w" src="./welcome_anime.mp4" autoplay loop="true" preload="auto"></video>
	</a-assets>
	<a-marker type="pattern" url="./pattern.patt">
		<a-video src="#video_w" scale="1 1 1" position="0 0 0" rotation="270 0 0" play="true"></a-video>
	</a-marker>

	<a-entity camera></a-entity>
</a-scene>
<script>
	// ビデオ格納用の変数定義を追加
	var video = null;

	AFRAME.registerComponent('registerevents', {
		init: function () {
			var marker = this.el;

			// マーカーを検出したイベントの登録
			marker.addEventListener('markerFound', function () {

				// マーカー認識したら、ビデオ再生
				if (video == null) {
					video = document.querySelector('#video_w');
				}
				video.play();
			});

			// マーカーを見失ったイベントの登録
			marker.addEventListener('markerLost', function () {
				
				// マーカー認識が外れたら、、ビデオ停止
				video.pause();
			});
		}
	});

	/* ビデオクリックで再生するイベントは、一旦コメントアウトしました
	window.addEventListener('click', function () {
		video = document.querySelector('#ar-video');
		video.play();
	});
	*/
</script>
</body>
</html>