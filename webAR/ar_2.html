<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ARsample2</title>
    <script type="text/javascript">
      document.addEventListener('DOMContentLoaded', (event) => {
        var orientation = screen.msOrientation || screen.mozOrientation || (screen.orientation || {}).type;
        if (orientation === "portrait-secondary" || orientation === "portrait-primary") {
          window.stop = true;
          var judge = confirm("このページは横向き専用です。　デバイスを横向きにしましたか？");
          if(judge) {
            window.stop = false;
          }else {
            alert("このページは横向き専用です。")
          }
        }
      });
    </script>
    
  </head>
  <body style="margin:0px; overflow:hidden;">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-spe-particles-component@^1.0.4/dist/aframe-spe-particles-component.min.js"></script>
    <script type="text/javascript">
      window.onload = function() {
        setTimeout(function(){
          window.scrollTo(0,1);
        }, 1);
      }

    </script>

    <a-scene embedded arjs="debugUIEnabled:false;" renderer="gammaOutput: true;" vr-mode-ui="enabled: false">
        <a-assets>
            <a-asset-item id="model" src="./ball/holo.fbx"></a-asset-item>
        </a-assets>

        <a-entity id="fly" scale="100 100 100" position="0 0.4 -3" animation-mixer="clip:*" fbx-model="#model" visible="true" onclick="particle();">
        </a-entity>

        <a-entity 
        id="particle"
        position = "0 0 0" 
        spe-particles="
            color: #aaf; 
            maxAge: 2; 
            maxAgeSpread: 1; 
            particleCount: 50; 
            opacity: 0,1,1,0; 
            positionSpread: 
            1.5 1.5 1.5; 
            velocitySpread: .4 .4 .4; 
            randomizePosition: true; 
            enabled:false;">
        </a-entity>

        <a-light type="ambient" color="#ffffff"></a-light>
        <a-light type="point" intensity="2" position="0 4 0"></a-light>
    </a-scene>
    <script>
        var t = 0;
        var fly = document.getElementById("fly");
        var particle = document.getElementById("particle");
        function render() {
        t += 0.0001;
        requestAnimationFrame(render);
        fly.setAttribute('position', '0 '+ 0.4+t +' -3');
        }
        render();

        function particle() {
            particle.position = fly.position;
            SPE.Emitter.prototype.enable;
            fly.visible = false;
        }
    </script>

</body>
</html>